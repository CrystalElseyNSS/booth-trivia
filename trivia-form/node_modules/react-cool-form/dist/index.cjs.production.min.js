"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),r=require("@babel/runtime/helpers/extends"),t=require("react"),n=require("dequal/lite");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=u(e),a=u(r),c=function(e){var r=t.useRef(e);return t.useEffect((function(){r.current=e})),r},o=function(e){return e.reduce((function(e,r){return e[r]=!0,e}),{})},l=function(e){return null!==e&&"object"==typeof e},s=function(e){return e instanceof FileList},f=function e(r){if(!l(r)||s(r))return r;if(r instanceof Date)return new Date(r.getTime());if(Array.isArray(r))return r.map((function(r){return e(r)}));if(l(r))return Object.keys(r).reduce((function(t,n){return t[n]=e(r[n]),t}),{});throw new Error("Unable to clone object.")},d=function e(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return t.reduce((function(r,t){return Object.keys(t).forEach((function(n){var u=r[n],i=t[n];Array.isArray(u)&&Array.isArray(i)?r[n]=[].concat(u,i):l(u)&&l(i)?r[n]=e(u,i):r[n]=i})),r}),{})},v=function(e){return!Array.isArray(e)&&l(e)},b=function(e){return void 0===e},y=function e(r,t){return!v(r)||r instanceof Date?t?r:void 0:Object.keys(r).reduce((function(n,u){var i=e(r[u],t[u]||!1);return b(i)?delete n[u]:n[u]=i,n}),{})},h=function(e,r,t){if(!v(e)||!r)return t;var n=r.split(/[,[\].]+?/).filter(Boolean).reduce((function(e,r){return(e||{})[r]}),e);return b(n)?t:n},m=function(e){return"checkbox"===e.type},p=function(e){return v(e)&&!Object.keys(e).length},k=function(e){return/INPUT|TEXTAREA|SELECT/.test(e.tagName)},g=function(e){return"file"===e.type},C=function(e){return"function"==typeof e},E=function(e){return"select-multiple"===e.type},A=function(e){return"radio"===e.type},w=function(e){return(window.requestIdleCallback||function(e){var r=Date.now();return setTimeout((function(){return e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-r))}})}),1)})(e,{timeout:2e3})},F=function(e,r,t,n){if(void 0===n&&(n=!1),!v(e))throw new TypeError("Expected an object.");var u=String(r).split(/[.[\]]+/).filter(Boolean),i=n?f(e):e;return u.slice(0,-1).reduce((function(e,r,t){if(l(e[r]))return e[r];var n=Number(u[t+1]);return e[r]=Number.isInteger(n)&&n>=0?[]:{},e[r]}),i)[u[u.length-1]||""]=t,i},R=function(e,r){return r.reduce((function(e,r){return e=F(e,r,!0,!0)}),e)},j=function(e,r,t){if(void 0===t&&(t=!1),!v(e))throw new TypeError("Expected an object.");var n=t?f(e):e,u=n;if(u.hasOwnProperty(r))return delete u[r],n;if(!b(h(u,r))){for(var i=r.split("."),a=i.pop();i.length&&"\\"===i[i.length-1].slice(-1);)a=i.pop().slice(0,-1)+"."+a;for(;i.length;)u=u[r=i.shift()];delete u[a]}return n},O=function(e,r){var u=t.useReducer((function(e){return e+1}),0)[1],i=t.useRef(e),o=t.useRef({}),l=c(r||function(){}),s=t.useCallback((function(e,r,t){var c=void 0===t?{}:t,s=c.fieldPath,f=c.shouldUpdate,d=void 0===f||f,b=e.split(".")[0];if(b){if("values"===b||!n.dequal(h(i.current,e),r)){var y=F(i.current,e,r,!0),m=y.errors,k=y.dirtyFields,g=y.isDirty,C=y.isValid,E=y.submitCount,A="dirtyFields"===b?!!function e(r,t){void 0===t&&(t=[]);for(var n=0,u=Object.values(r);n<u.length;n++){var i=u[n];if(!0===i)return t.push(i),t;v(i)&&e(i,t)}return t}(k).length:g,w="errors"===b?p(m):C,R="isSubmitting"===b&&r?E+=1:E;i.current=a.default({},y,{isDirty:A,isValid:w,submitCount:R}),e=s||e,d&&(Object.keys(o.current).some((function(r){return e.startsWith(r)||r.startsWith(e)}))||o.current.isDirty&&A!==g||o.current.isValid&&w!==C)&&(u(),l.current(i.current))}}else n.dequal(i.current,r)||(i.current=r,u(),l.current(i.current))}),[l]),f=t.useCallback((function(e){o.current[e]=!0}),[]);return{stateRef:i,setStateRef:s,setUsedStateRef:f}},S="undefined"==typeof window?t.useEffect:t.useLayoutEffect;exports.get=h,exports.set=F,exports.unset=j,exports.useForm=function(e){var r=e.defaultValues,n=void 0===r?{}:r,u=e.validate,l=e.validateOnChange,f=void 0===l||l,V=e.validateOnBlur,D=void 0===V||V,L=e.removeUnmountedField,x=void 0===L||L,P=e.ignoreFields,T=void 0===P?[]:P,q=e.onReset,N=e.onSubmit,U=e.onError,B=e.debug,I=t.useRef(!0),M=t.useRef(null),W=t.useRef({}),_=t.useRef({}),X=t.useRef({}),z=t.useRef(o(T)),G=t.useRef(),H=c(u),J=t.useRef({}),K=c(q||function(){}),Q=c(N||function(){}),Y=c(U||function(){}),Z=t.useRef(n),$=t.useRef({values:Z.current,touched:{},errors:{},isDirty:!1,dirtyFields:{},isValidating:!1,isValid:!0,isSubmitting:!1,isSubmitted:!1,submitCount:0}),ee=O($.current,B),re=ee.stateRef,te=ee.setStateRef,ne=ee.setUsedStateRef,ue=t.useCallback((function(e){return Array.from(e.querySelectorAll("input,textarea,select")).filter((function(e){var r=e,t=r.type,n=r.name,u=r.dataset;return!/image|submit|reset/.test(t)&&(!!n&&(X.current[n]||!(u.rcfIgnore||z.current[n])))})).reduce((function(e,r){var t=r,n=t.name;return e[n]=a.default({},e[n],{field:r}),(m(t)||A(t))&&(e[n].options=e[n].options?[].concat(e[n].options,[r]):[r]),e}),{})}),[]),ie=t.useCallback((function(){return Object.keys(a.default({},W.current,X.current))}),[]),ae=t.useCallback((function(e,r,t,n){te(e,j(t,n,!0),{fieldPath:r})}),[te]),ce=t.useCallback((function(e){return function(r){if(null!=r&&r.name&&!X.current[r.name]&&!z.current[r.name])if(C(e))J.current[r.name]=e;else{var t=e.validate,n=i.default(e,["validate"]);t&&(J.current[r.name]=t),_.current[r.name]=n}}}),[]),oe=t.useCallback((function(e){var r,t=W.current[e],n=t.field,u=t.options,i=n.value;if("INPUT"===n.tagName){var a,c;if(null!=(a=_.current[e])&&a.valueAsNumber)return i=n.valueAsNumber;if(null!=(c=_.current[e])&&c.valueAsDate)return i=n.valueAsDate}if((function(e){return"number"===e.type}(n)||function(e){return"range"===e.type}(n))&&(i=n.valueAsNumber||""),m(n))if(u){var o=u;i=u.length>1?o.filter((function(e){return e.checked})).map((function(e){return e.value})):o[0].checked}else{var l=h(re.current.values,n.name);Array.isArray(l)?(l=new Set(l),n.checked?l.add(i):l.delete(i),i=Array.from(l)):i=n.checked}return A(n)&&u&&(i=(null==(r=u.find((function(e){return e.checked})))?void 0:r.value)||""),E(n)&&!u&&(i=Array.from(n.options).filter((function(e){return e.selected})).map((function(e){return e.value}))),g(n)&&(i=n.files),i}),[re]),le=t.useCallback((function(e,r){if(W.current[e]&&!X.current[e]){var t=W.current[e],n=t.field,u=t.options;if(m(n)){var i=u;i.length>1?i.forEach((function(e){e.checked=Array.isArray(r)?r.includes(e.value):!!r})):i[0].checked=!!r}else A(n)?u.forEach((function(e){e.checked=e.value===r})):E(n)&&Array.isArray(r)?Array.from(n.options).forEach((function(e){e.selected=!!r.includes(e.value)})):g(n)?(s(r)&&(n.files=r),r||(n.value="")):n.value=null!=r?r:""}}),[]),se=t.useCallback((function(e,r){b(h($.current.values,e))&&($.current.values=F($.current.values,e,r,!0),te("values."+e,h($.current.values,e),{shouldUpdate:!I.current}))}),[te]),fe=t.useCallback((function(e,r){return void 0===r&&(r=!1),Object.values(W.current).forEach((function(t){var n=t.field.name;if(!X.current[n]){var u=h(e,n);if(b(u)||le(n,u),r){var i=h(Z.current,n);se(n,b(i)?oe(n):i)}}}))}),[oe,se,le]),de=t.useCallback((function(e,r){var t,n=void 0===r?{}:r,u=n.target,i=n.watch,a=void 0===i||i,c=n.filterUntouchedError,o=void 0===c||c,l=function(e){return u?u+"."+e:e},s=function(e,r){return a&&o&&e.startsWith("errors")&&r&&!p(r)?(e=e.replace("errors","touched"),ne(e),y(r,h(re.current,e))):r};if(Array.isArray(e))t=e.map((function(e){return e=l(e),a&&ne(e),s(e,h(re.current,e))}));else if(v(e)){var f=e;t=Object.keys(f).reduce((function(r,t){return e=l(f[t]),a&&ne(e),r[t]=s(e,h(re.current,e)),r}),{})}else e=l(e),a&&ne(e),t=s(e,h(re.current,e));return t}),[ne,re]),ve=t.useCallback((function(e){te("errors",(C(e)?e(re.current.errors):e)||{})}),[te,re]),be=t.useCallback((function(e,r){(r=C(r)?r(h(re.current.errors,e)):r)?te("errors."+e,r):ae("errors","errors."+e,re.current.errors,e)}),[ae,te,re]),ye=t.useCallback((function(e){var r;return null==(r=W.current[e])?void 0:r.field.validationMessage}),[]),he=t.useCallback((function(){return Object.keys(W.current).reduce((function(e,r){var t=ye(r);return e=a.default({},e,t?F({},r,t):{})}),{})}),[ye]),me=t.useCallback((async function(e){if(J.current[e])try{return await J.current[e](h(re.current.values,e),re.current.values)}catch(e){throw e}}),[re]),pe=t.useCallback((function(){var e=Object.keys(J.current).map((function(e){return me(e)}));return Promise.all(e).then((function(e){return Object.keys(J.current).reduce((function(r,t,n){return r=a.default({},r,e[n]?F({},t,e[n]):{})}),{})}))}),[me]),ke=t.useCallback((async function(e){if(!H.current)return e?void 0:{};try{var r=await H.current(re.current.values);return e?h(r,e):v(r)?r:{}}catch(e){throw e}}),[H,re]),ge=t.useCallback((async function(e){te("isValidating",!0);try{var r=await ke(e)||await me(e)||ye(e);return be(e,r),te("isValidating",!1),r}catch(e){return e}}),[ye,me,ke,be,te]),Ce=t.useCallback((function(e){return w((function(){return ge(e)}))}),[ge]),Ee=t.useCallback((function(){return te("isValidating",!0),Promise.all([he(),pe(),ke()]).then((function(e){var r=d.apply(void 0,e);return ve(r),te("isValidating",!1),r}))}),[he,pe,ke,ve,te]),Ae=t.useCallback((function(){return w(Ee)}),[Ee]),we=t.useCallback((function(e){h(re.current.values,e)!==h($.current.values,e)?te("dirtyFields."+e,!0):ae("dirtyFields","dirtyFields."+e,re.current.dirtyFields,e)}),[ae,te,re]),Fe=t.useCallback((function(e,r){void 0===r&&(r=D),te("touched."+e,!0),r&&Ce(e)}),[te,Ce,D]),Re=t.useCallback((function(e){return Fe(e,f?e!==G.current:void 0)}),[Fe,f]),je=t.useCallback((function(e,r){var t=void 0===r?{}:r,n=t.shouldValidate,u=void 0===n?f:n,i=t.touchedFields,a=void 0===i?[]:i,c=t.dirtyFields,o=void 0===c?[]:c;e=C(e)?e(re.current.values):e,te("values",e),fe(e),a.length&&te("touched",R(re.current.touched,C(a)?a(ie()):a)),o.length&&te("dirtyFields",R(re.current.dirtyFields,C(o)?o(ie()):o)),u&&Ae()}),[ie,fe,te,re,Ae,f]),Oe=t.useCallback((function(e,r,t){var n=void 0===t?{}:t,u=n.shouldValidate,i=void 0===u?f:u,a=n.shouldTouched,c=void 0===a||a,o=n.shouldDirty,l=void 0===o||o;r=C(r)?r(h(re.current.values,e)):r,b(r)?ae("values","values."+e,re.current.values,e):te("values."+e,r),le(e,r),c&&Fe(e,!1),l&&we(e),i&&Ce(e)}),[ae,we,Fe,le,te,re,Ce,f]),Se=t.useCallback((function(){return{formState:re.current,setErrors:ve,setFieldError:be,setValues:je,setFieldValue:Oe,validateForm:Ee,validateField:ge,reset:Ve,submit:De}}),[Ve,ve,be,Oe,je,re,De,ge,Ee]),Ve=t.useCallback((function(e,r,t){null==t||t.preventDefault(),null==t||t.stopPropagation();var n=a.default({},re.current),u=o(r||[]);Object.keys(n).forEach((function(r){u[r]||("values"===r?(e=(C(e)?e(re.current.values):e)||$.current.values,n[r]=e,fe(e)):n[r]=$.current[r])})),te("",n),K.current(n.values,Se(),t)}),[Se,K,fe,te,re]),De=t.useCallback((async function(e){null==e||e.preventDefault(),null==e||e.stopPropagation();var r=re.current,t=r.touched,n=r.values;te("touched",R(t,ie())),te("isSubmitting",!0);try{var u=await Ee();return p(u)?(await Q.current(n,Se(),e),te("isSubmitted",!0),{values:n}):(Y.current(u,Se(),e),{errors:u})}catch(e){throw e}finally{te("isSubmitting",!1)}}),[ie,Se,Y,Q,te,re,Ee]),Le=t.useCallback((function(e,r){te("values."+e,r),we(e),f&&Ce(e)}),[we,te,Ce,f]),xe=t.useCallback((function(e,r){var t,n=void 0===r?{}:r,u=n.validate,i=n.value,a=n.defaultValue,c=n.parse,o=n.format,l=n.onChange,s=n.onBlur;if(e){X.current[e]=!0,u&&(J.current[e]=u);var f=h(Z.current,e);return a=b(f)?a:f,b(a)||se(e,a),i=b(i)?de("values."+e):i,i=null!=(t=o?o(i):i)?t:"",{name:e,value:i,onChange:function(r){var t=r.nativeEvent instanceof Event&&k(r.target)?oe(e):r;Le(e,c?c(t):t),l&&l(r,t),G.current=e},onBlur:function(r){Re(e),s&&s(r),G.current=void 0}}}}),[oe,de,Le,se,Re]);return S((function(){M.current&&(W.current=ue(M.current),fe($.current.values,!0),I.current=!1)}),[ue,fe]),t.useEffect((function(){if(!M.current)return function(){return null};var e=function(e){var r=e.target.name;if(r&&W.current[r]&&!X.current[r]){var t,n=null==(t=_.current[r])?void 0:t.parse,u=oe(r);Le(r,n?n(u):u),G.current=r}},r=function(e){var r=e.target;if(k(r)){var t=r.name;W.current[t]&&!X.current[t]&&(Re(t),G.current=void 0)}},t=function(e){return De(e)},n=function(e){return Ve(null,null,e)},u=M.current;u.addEventListener("input",e),u.addEventListener("focusout",r),u.addEventListener("submit",t),u.addEventListener("reset",n);var i=new MutationObserver((function(e){if("childList"===e[0].type){var r=ue(u),t=re.current.values;x&&Object.keys(W.current).forEach((function(e){r[e]||(ae("values","values."+e,re.current.values,e),ae("touched","touched."+e,re.current.touched,e),ae("dirtyFields","dirtyFields."+e,re.current.dirtyFields,e),ae("errors","errors."+e,re.current.errors,e),$.current.values=j($.current.values,e,!0),delete _.current[e],delete J.current[e],delete X.current[e])}));var n=!1;Object.keys(r).forEach((function(e){if(!W.current[e]&&!X.current[e]){var r=h(Z.current,e);b(r)||(t=F(t,e,r,!0)),n=!0}})),W.current=r,n&&fe(t,!0)}}));return i.observe(u,{childList:!0,subtree:!0}),function(){u.removeEventListener("input",e),u.removeEventListener("focusout",r),u.removeEventListener("submit",t),u.removeEventListener("reset",n),i.disconnect()}}),[ue,oe,Le,ae,x,Ve,fe,Re,re,De]),{form:M,field:ce,getState:de,setErrors:ve,setFieldError:be,setValues:je,setFieldValue:Oe,validateForm:Ee,validateField:ge,reset:Ve,submit:De,controller:xe}};
//# sourceMappingURL=index.cjs.production.min.js.map
